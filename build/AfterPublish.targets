<Project>
  <PropertyGroup>
    <__DirectoryName Condition="'$(Engine)' == 'WindowsDX'">Windows</__DirectoryName>
    <__DirectoryName Condition="'$(Engine)' == 'WindowsGL' Or '$(Engine)' == 'UniversalGL'">OpenGL</__DirectoryName>
    <__DirectoryName Condition="'$(Engine)' == 'WindowsXNA'">XNA</__DirectoryName>
  </PropertyGroup>

  <Target Name="PatchAppHost" AfterTargets="Publish" Condition="'$(TargetFrameworkIdentifier)' != '.NETFramework'">
    <PropertyGroup>
      <__AssemblyFileName Condition="Exists('$(PublishDir)$(AssemblyName).dll')">$(PublishDir)$(AssemblyName).dll</__AssemblyFileName>
      <__AssemblyFileName Condition="Exists('$(PublishDir)$(AssemblyName)')">$(PublishDir)$(AssemblyName)</__AssemblyFileName>
      <__AssemblyFileName Condition="Exists('$(PublishDir)$(AssemblyName).exe')">$(PublishDir)$(AssemblyName).exe</__AssemblyFileName>
    </PropertyGroup>
    <Message Importance="high" Text="AppHostPatcher $(__AssemblyFileName)"></Message>
    <Exec ConsoleToMsBuild="True" Command="&quot;$(MSBuildThisFileDirectory)..$([System.IO.Path]::DirectorySeparatorChar)AdditionalFiles$([System.IO.Path]::DirectorySeparatorChar)AppHostPatcher$([System.IO.Path]::DirectorySeparatorChar)AppHostPatcher.exe&quot; &quot;$(__AssemblyFileName)&quot; &quot;$(AssemblyName).dll&quot; &quot;Binaries$([System.IO.Path]::DirectorySeparatorChar)$(__DirectoryName)$([System.IO.Path]::DirectorySeparatorChar)$(AssemblyName).dll&quot;" />
  </Target>

  <Target Name="RemoveSDL" AfterTargets="Publish" Condition="'$(TargetFrameworkIdentifier)' == '.NETFramework'">
    <Delete Condition="'$(Engine)' == 'UniversalGL' Or '$(Engine)' == 'WindowsGL'" Files="$(PublishDir)SDL2.dll" />
    <Delete Condition="'$(Engine)' == 'UniversalGL' Or '$(Engine)' == 'WindowsGL'" Files="$(PublishDir)soft_oal.dll" />
  </Target>
</Project>